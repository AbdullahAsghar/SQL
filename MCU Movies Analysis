select * from box_office;

-- What is the total global revenue generated by all Marvel movies in the dataset?

select sum (box_office_gross_worldwide) 
as total_box_office_collection
from box_office;

-- Total global revenue generated by all Marvel movies is approx. $29 billion, or $29,493,057,166.

-- How many Marvel movies are included in the dataset?

select count (distinct film)
as #films
from box_office;

-- A total of 32 MCU films are included in the dataset.

-- What is the average worldwide box office revenue for Marvel movies?

select avg (box_office_gross_worldwide)
as average_collection
from box_office;

-- The average collection is $921,658,036, or approx. $921 million.

-- Which Marvel movie had the highest box office revenue?

select top (1) film, box_office_gross_worldwide
from box_office
order by box_office_gross_worldwide desc;

-- Avengers: Endgame remained the highest grossing movie, with revenue totalling to $2,797,800,564 or approx. $2 billion.

-- Which Marvel movie had the lowest box office revenue?

select top (1) film, box_office_gross_worldwide
from box_office
order by box_office_gross_worldwide asc;

-- The Incredible Hulk is the lowest grossing movie with total revenue of $264,770,996 or $264 million.

-- How many Marvel movies were released in each year?

select year_release, count (film) as films_released
from box_office
group by year_release
order by year_release desc;

-- Results show that the most number of movies (4) were released in 2021.

-- What is the highest-grossing Marvel movie released in each year?

select a.film, b.year_release, b.max_revenue
from (
	select year_release, max (box_office_gross_worldwide) as max_revenue
	from box_office
	group by year_release) b
inner join box_office a
on a.year_release = b.year_release and a.box_office_gross_worldwide = b.max_revenue;

-- What is the total box office revenue for each phase of the Marvel Cinematic Universe (MCU)?

select * from box_office;

select phase, sum (box_office_gross_worldwide) as total_collection
from box_office
group by phase
order by total_collection desc;

-- Query shows the phase with highest box office collection is Phase Three.

-- Which director has directed the most Marvel movies in the dataset?

select top (1) director, count (film) as films_directed
from box_office
group by director
order by films_directed desc;

-- Anthony and Joe Russo have directed the most number of movies i.e. 4.

-- What is the average box office revenue for Marvel movies directed by each director?

select director, avg (box_office_gross_worldwide) as avg_collection
from box_office
group by director
order by avg_collection desc;

-- Anthony and Joe Russo come on top, with average collection of $1.6 billion, or $1,678,469,528.

-- What is the average budget for Marvel movies in each phase of the MCU?

select phase, avg(cast(budget as decimal (18,1))) as average_budget
from box_office
group by phase
order by average_budget;

-- CAST function was used because the average was returning decimal figures as results, which ultimately led to arithmetic overflow error.
-- Phase Five has the highest average budget of approx $225 million or $ 225,000,000.

-- Which Marvel movie had the highest budget?

select top (1) film, budget
from box_office
order by budget desc;

-- Avengers: Age of Ultronhad the highest budget of $ 444 million, or $444,000,000.

select * from box_office;

-- How many Marvel movies were released in each month of the year?

select month(u_s_release_date) as months, count (film) as films_released
from box_office
group by month(u_s_release_date)
order by months;

-- What is the average box office revenue for Marvel movies released in each month?

select month(u_s_release_date) as month, count (film) as #films, avg (box_office_gross_worldwide) as avgcollection
from box_office
group by month(u_s_release_date)
order by avgcollection desc;

-- Highest average box office collection stands for December at $1.9 billion, or $1,916,306,995.

-- What is the profitability of MCU movies?

select film, (box_office_gross_worldwide - budget) as revenue,
case
	when (box_office_gross_worldwide - budget) > 1000000000 then 'woohoo'
	when (box_office_gross_worldwide - budget) < 1000000000 and (box_office_gross_worldwide - budget) > 400000000 then 'amazing'
	when (box_office_gross_worldwide - budget) < 400000000 then 'meh'
	else null
end as revenue_status,
concat(((box_office_gross_worldwide - budget) * 100 / box_office_gross_worldwide), '%') as profitpercentage
from box_office
order by revenue desc;

-- All movies have been profitable, with Spider-man: No Way Home standing at a, 89% profitability.

-- What is the total profit generated by movies released in each year?

select year (u_s_release_date) as years, sum (box_office_gross_worldwide - budget) as totalprofitability
from box_office
group by year (u_s_release_date)
order by totalprofitability desc;

-- 2019 remains the best year for MCU, with around $4.3 billion in profit, or $4,323,003,823.
